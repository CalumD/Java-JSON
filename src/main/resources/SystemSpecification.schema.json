{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "",
  "title": "CS4099 System Config Schema",
  "description": "This schema should be used to lay out the structure of a single 'system' of the SH framework for lightweight component and channel abstractions for uni-kernel based distributed systems.",
  "type": "object",
  "properties": {
    "system": {
      "description": "This is the container object for a system description. This allows other arbitrary JSON data to be defined here for advanced/future work/development.",
      "type": "object",
      "properties": {
        "name": {
          "description": "This is a human readable value for the 'name' of the system defined by this config.",
          "type": "string",
          "maxLength": 100
        },
        "description": {
          "description": "This is a human readable description of the overall function the system defined by this config performs.",
          "type": "string",
          "maxLength": 10000
        },
        "rolesDirectory": {
          "description": "This is an ABSOLUTE path to the directory containing the various role classes. Must begin and end with a '/'.",
          "type": "string",
          "maxLength": 10000
        },
        "roles": {
          "description": "This contains a collection of definitions for the roles this system can enlist.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/roleDeclaration"
          },
          "uniqueItems": true,
          "additionalItems": false
        },
        "machines": {
          "description": "This contains a collection of nodes within this system.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/machine"
          },
          "additionalItems": false
        }
      },
      "required": [
        "rolesDirectory",
        "roles",
        "machines"
      ],
      "additionalProperties": false
    }
  },
  "required": [
    "system"
  ],
  "definitions": {
    "roleDeclaration": {
      "type": "object",
      "properties": {
        "name": {
          "description": "This is a human readable name for this role.",
          "type": "string",
          "maxLength": 100
        },
        "description": {
          "description": "This is a human readable description of the function this role carries out.",
          "type": "string",
          "maxLength": 5000
        },
        "id": {
          "description": "This is the id the system will use for this role internally. Must be unique.",
          "type": "string",
          "minLength": 1,
          "maxLength": 1000
        },
        "path": {
          "description": "This can either be an absolute path to a role, or relative to the end of the 'system.rolesDirectory' property.",
          "type": "string",
          "minLength": 1,
          "maxLength": 10000
        }
      },
      "required": [
        "id",
        "path"
      ],
      "additionalProperties": false
    },
    "machine": {
      "type": "object",
      "properties": {
        "name": {
          "description": "This is the human readable name or identifier of this machine.",
          "type": "string",
          "minLength": 1,
          "maxLength": 1000
        },
        "address": {
          "description": "This is the network address to find this machine at, may be an IP address or valid hostname",
          "type": "string",
          "anyOf": [
            {
              "format": "hostname"
            },
            {
              "format": "ipv4"
            },
            {
              "format": "ipv6"
            }
          ]
        },
        "arp": {
          "description": "This is the network address to use when resolving dynamic component roles",
          "type": "string",
          "anyOf": [
            {
              "format": "hostname"
            },
            {
              "format": "ipv4"
            },
            {
              "format": "ipv6"
            }
          ]
        },
        "components": {
          "description": "This is an array of the roles that this component employs",
          "type": "array",
          "items": {
            "$ref": "#/definitions/roleUse"
          },
          "additionalItems": false
        }
      },
      "required": [
        "name",
        "address",
        "components"
      ],
      "additionalProperties": false
    },
    "roleUse": {
      "type": "object",
      "properties": {
        "role": {
          "description": "This must equal an id of a role defined for this system.",
          "type": "string",
          "oneOf": [
            {
              "$ref": "#/definitions/roleDeclaration/properties/id"
            }
          ]
        },
        "custom": {
          "description": "This is any additional data this instance of the role may need. This is custom and optional, but must be a valid JSON object.",
          "type": "object",
          "$schema": "http://json-schema.org/draft-07/schema",
          "properties": {}
        }
      },
      "required": [
        "role"
      ],
      "additionalProperties": false
    }
  }
}